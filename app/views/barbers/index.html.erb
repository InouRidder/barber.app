<div class="container">
	<div class="row">
   <div class="col-md-9-offset col-md-4-offset">
     <h1><span>
       Find your favorite barber
     </span></h1>
   </div>
 </div>
</div>

<div class="container container-index">
  <div class="row row-index">
    <% @barbers.each do |barber| %>
    <div class="col-xs-12  col-md-4">
    <div class="card-background">
      <div class="card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url(<%= image_path(barber.picture) %>);">
       <div class="card-title">


<!--         <div class="card-description">
 -->          <p>
            <%= barber.description[0..100] %>...
            <% average = 0 %>
            <% barber.reviews.each do |e| %>
            <% average += e.rating.to_i %>
            <% end %>
          </p>
        <!-- </div> -->
         </div>

        <div class="card-rating">
          Rating:

          <% if barber.reviews.length == 0 %>
          <%= "Not Rated Yet!" %>
          <% else %>
          <%= average/barber.reviews.length %>
          <% end %>
        </div>
        <%= image_tag "beardman.png", class: "card-user avatar" %>

      </div>
        <h2>
          <%= link_to "#{barber.name}", barber_path(barber), class: "barbername" %>
        </h2>
      </div>
    </div>
    <% end %>
  </div>
</div>

<div id="map" style="width: 100%; height: 600px;"></div>

<% content_for(:after_js) do %>
<%= javascript_tag do %>
var styles = [{"featureType":"all","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"all","stylers":[{"visibility":"off"}]},{"featureType":"landscape.man_made","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#ede7d6"}]},{"featureType":"poi.attraction","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.business","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.government","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.medical","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"visibility":"on"},{"hue":"#70ff00"},{"gamma":"1.52"},{"lightness":"-27"},{"saturation":"-70"}]},{"featureType":"poi.place_of_worship","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.school","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"poi.sports_complex","elementType":"geometry","stylers":[{"color":"#b49e89"}]},{"featureType":"road","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#995b5b"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"},{"color":"#e7a0a0"}]},{"featureType":"road.highway","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"road.local","elementType":"geometry.fill","stylers":[{"color":"#be8686"}]},{"featureType":"transit","elementType":"geometry.fill","stylers":[{"color":"#f2d2d2"}]},{"featureType":"water","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#7ca9c2"}]}]

$(document).ready(function() {
var handler = Gmaps.build('Google');
handler.buildMap({ provider: {scrollwheel: false, styles: styles}, internal: { id: 'map' } }, function() {
markers = handler.addMarkers(<%= raw @coordinates.to_json %>);
handler.bounds.extendWith(markers);
handler.fitMapToBounds();
if (markers.length == 0) {
handler.getMap().setZoom(2);
} else if (markers.length == 1) {
handler.getMap().setZoom(14);
handler.disableScrollWheelZoom();

}
});
});
<% end %>
<% end %>

