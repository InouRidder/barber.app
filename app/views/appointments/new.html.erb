<div class="container">
  <div class="row">
    <div>
      <h2>New appointment with <%= @barber.name %> </h2>


      <%= simple_form_for ([@barber, @appointment]) do |f| %>

      <%= f.input :date, as: :datetime, html5: true %>
      <%= f.input :barber_service, collection: @barber_services  %>
      <p>
        <%= f.button :submit %>
      </p>


      <% end %>
    </div>
  </div>

<h4> Availability </h4>

  <div id="appointments">
    <h3 id="month">
      <%= link_to "<", date: @date.prev_week %>
      <%= @date.strftime("%B %Y") %>
      <%= link_to ">", date: @date.next_week %>
    </h3>
      <%= calendar @date do |date| %>
        <%= date.day %>
        <% if @appointments_by_date[date] %>
          <ul>
            <% @appointments_by_date[date].each do |appointment| %>
             <li> occupied from <%= appointment.date.strftime("%Hh%M") %> until <%= (appointment.date + (appointment.barber_service.duration * 60)).strftime("%Hh%M") %> </li>
            <% end %>
          </ul>
        <% end %>
      <% end %>
  </div>
</div>


